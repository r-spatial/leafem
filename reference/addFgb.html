<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add a flatgeobuf file to leaflet map — addFgb • leafem</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add a flatgeobuf file to leaflet map — addFgb"><meta name="description" content="flatgeobuf is a performant binary geo-spatial file format suitable for
serving large data. For more details see
https://github.com/flatgeobuf/flatgeobuf and the respective
documentation for the GDAL/OGR driver at
https://gdal.org/en/latest/drivers/vector/flatgeobuf.html.

In contrast to classical ways of serving data from R onto a leaflet map,
flatgeobuf can stream the data chunk by chunk so that rendering of the map
is more or less instantaneous. The map is responsive while data is still
loading so that popup queries, zooming and panning will work even
though not all data has been rendered yet. This makes for a rather pleasant
user experience as we don't have to wait for all data to be added to the map
before interacting with it."><meta property="og:description" content="flatgeobuf is a performant binary geo-spatial file format suitable for
serving large data. For more details see
https://github.com/flatgeobuf/flatgeobuf and the respective
documentation for the GDAL/OGR driver at
https://gdal.org/en/latest/drivers/vector/flatgeobuf.html.

In contrast to classical ways of serving data from R onto a leaflet map,
flatgeobuf can stream the data chunk by chunk so that rendering of the map
is more or less instantaneous. The map is responsive while data is still
loading so that popup queries, zooming and panning will work even
though not all data has been rendered yet. This makes for a rather pleasant
user experience as we don't have to wait for all data to be added to the map
before interacting with it."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">leafem</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3.9016</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatial/leafem/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Add a flatgeobuf file to leaflet map</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-spatial/leafem/blob/master/R/file.R" class="external-link"><code>R/file.R</code></a></small>
      <div class="d-none name"><code>addFgb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>flatgeobuf is a performant binary geo-spatial file format suitable for
serving large data. For more details see
<a href="https://github.com/flatgeobuf/flatgeobuf" class="external-link">https://github.com/flatgeobuf/flatgeobuf</a> and the respective
documentation for the GDAL/OGR driver at
<a href="https://gdal.org/en/latest/drivers/vector/flatgeobuf.html" class="external-link">https://gdal.org/en/latest/drivers/vector/flatgeobuf.html</a>. <br><br>
In contrast to classical ways of serving data from R onto a leaflet map,
flatgeobuf can stream the data chunk by chunk so that rendering of the map
is more or less instantaneous. The map is responsive while data is still
loading so that popup queries, zooming and panning will work even
though not all data has been rendered yet. This makes for a rather pleasant
user experience as we don't have to wait for all data to be added to the map
before interacting with it.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">addFgb</span><span class="op">(</span></span>
<span>  <span class="va">map</span>,</span>
<span>  file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  url <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  layerId <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  popup <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  radius <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  stroke <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"#03F"</span>,</span>
<span>  weight <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  opacity <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  fill <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fillColor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fillOpacity <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  dashArray <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  options <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  className <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scale <span class="op">=</span> <span class="fu">scaleOptions</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  minZoom <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxZoom <span class="op">=</span> <span class="fl">52</span>,</span>
<span>  highlightOptions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  labelOptions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-map">map<a class="anchor" aria-label="anchor" href="#arg-map"></a></dt>
<dd><p>a mapview or leaflet object.</p></dd>


<dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>file path to the .fgb file to be added to <code>map</code>.
If set, <code>url</code> is ignored.</p></dd>


<dt id="arg-url">url<a class="anchor" aria-label="anchor" href="#arg-url"></a></dt>
<dd><p>url of the data to be added to <code>map</code>. Only respected if
<code>file = NULL</code>.</p></dd>


<dt id="arg-layerid">layerId<a class="anchor" aria-label="anchor" href="#arg-layerid"></a></dt>
<dd><p>the layer id.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>the group name for the file to be added to <code>map</code>.</p></dd>


<dt id="arg-popup">popup<a class="anchor" aria-label="anchor" href="#arg-popup"></a></dt>
<dd><p>either a logical of whether to show the feature properties
(fields) in popups or the name of the field to show in popups.</p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>name of the field to be shown as a tooltip.</p></dd>


<dt id="arg-radius">radius<a class="anchor" aria-label="anchor" href="#arg-radius"></a></dt>
<dd><p>the size of the circle markers.</p></dd>


<dt id="arg-stroke">stroke<a class="anchor" aria-label="anchor" href="#arg-stroke"></a></dt>
<dd><p>whether to draw stroke along the path
(e.g. the borders of polygons or circles).</p></dd>


<dt id="arg-color">color<a class="anchor" aria-label="anchor" href="#arg-color"></a></dt>
<dd><p>stroke color.</p></dd>


<dt id="arg-weight">weight<a class="anchor" aria-label="anchor" href="#arg-weight"></a></dt>
<dd><p>stroke width in pixels.</p></dd>


<dt id="arg-opacity">opacity<a class="anchor" aria-label="anchor" href="#arg-opacity"></a></dt>
<dd><p>stroke opacity.</p></dd>


<dt id="arg-fill">fill<a class="anchor" aria-label="anchor" href="#arg-fill"></a></dt>
<dd><p>whether to fill the path with <code>fillColor</code>. If <code>fillColor</code>
is set, this will be set to <code>TRUE</code>, default is <code>FALSE</code>.</p></dd>


<dt id="arg-fillcolor">fillColor<a class="anchor" aria-label="anchor" href="#arg-fillcolor"></a></dt>
<dd><p>fill color. If set, <code>fill</code> will be set to <code>TRUE</code>.</p></dd>


<dt id="arg-fillopacity">fillOpacity<a class="anchor" aria-label="anchor" href="#arg-fillopacity"></a></dt>
<dd><p>fill opacity.</p></dd>


<dt id="arg-dasharray">dashArray<a class="anchor" aria-label="anchor" href="#arg-dasharray"></a></dt>
<dd><p>a string that defines the stroke dash pattern.</p></dd>


<dt id="arg-options">options<a class="anchor" aria-label="anchor" href="#arg-options"></a></dt>
<dd><p>a list of extra options for tile layers, popups, paths
(circles, rectangles, polygons, ...), or other map elements.</p></dd>


<dt id="arg-classname">className<a class="anchor" aria-label="anchor" href="#arg-classname"></a></dt>
<dd><p>optional class name for the popup (table). Can be used
to define css for the popup.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>named list with instructions on how to scale radius, width,
opacity, fillOpacity if those are to be mapped to an attribute column.</p></dd>


<dt id="arg-minzoom">minZoom<a class="anchor" aria-label="anchor" href="#arg-minzoom"></a></dt>
<dd><p>minimum zoom level at which data should be rendered.</p></dd>


<dt id="arg-maxzoom">maxZoom<a class="anchor" aria-label="anchor" href="#arg-maxzoom"></a></dt>
<dd><p>maximum zoom level at which data should be rendered.</p></dd>


<dt id="arg-highlightoptions">highlightOptions<a class="anchor" aria-label="anchor" href="#arg-highlightoptions"></a></dt>
<dd><p>Options for highlighting the shape on mouse over.</p></dd>


<dt id="arg-labeloptions">labelOptions<a class="anchor" aria-label="anchor" href="#arg-labeloptions"></a></dt>
<dd><p>A Vector of <code><a href="https://rstudio.github.io/leaflet/reference/map-options.html" class="external-link">labelOptions</a></code> to provide label
options for each label. Default <code>NULL</code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>currently not used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Styling options in <code>addFgb</code> offer flexibility by allowing
users to either specify styles directly as function arguments or define them
as attributes in the data object:</p><ul><li><p><strong>Direct Styling:</strong> You can pass style arguments (e.g., <code>color</code>, <code>weight</code>,
<code>opacity</code>) directly to the function. These will apply uniformly to all features
in the layer.</p></li>
<li><p><strong>Attribute-based Styling:</strong> Alternatively, you can include styling properties
(e.g., <code>color</code>, <code>fillColor</code>, <code>weight</code>) as columns in your data object before
writing it to an FGB file. Set the corresponding arguments in <code>addFgb</code> to
<code>NULL</code>, and the function will use these attributes for styling during map
rendering.</p>
<p>For example:</p>
<p></p><div class="sourceCode R"><pre><code><span><span class="co">## using custom `color`</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/colorNumeric.html" class="external-link">colorNumeric</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"viridis"</span>, domain <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">var</span><span class="op">)</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">var</span><span class="op">)</span></span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">st_write</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">data</span>, dsn <span class="op">=</span> <span class="st">"myfile.fgb"</span>, driver <span class="op">=</span> <span class="st">"FlatGeobuf"</span><span class="op">)</span></span>
<span><span class="fu">leafem</span><span class="fu">::</span><span class="fu"><a href="../reference/addFgb.html">addFgb</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"myfile.fgb"</span>, color <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## using custom `fillColor`</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">fillColor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/colorNumeric.html" class="external-link">colorNumeric</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"viridis"</span>, domain <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">var</span><span class="op">)</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">var</span><span class="op">)</span></span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">st_write</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">data</span>, dsn <span class="op">=</span> <span class="st">"myfile.fgb"</span>, driver <span class="op">=</span> <span class="st">"FlatGeobuf"</span><span class="op">)</span></span>
<span><span class="fu">leafem</span><span class="fu">::</span><span class="fu"><a href="../reference/addFgb.html">addFgb</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"myfile.fgb"</span>, fill <span class="op">=</span> <span class="cn">TRUE</span>, fillColor <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre><p></p></div></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/leafem" class="external-link">leafem</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># via URL</span></span></span>
<span class="r-in"><span>   <span class="va">url</span> <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/flatgeobuf/flatgeobuf/3.0.1/test/data/UScounties.fgb"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>     <span class="fu">leafem</span><span class="fu">:::</span><span class="fu">addFgb</span><span class="op">(</span></span></span>
<span class="r-in"><span>       url <span class="op">=</span> <span class="va">url</span></span></span>
<span class="r-in"><span>       , group <span class="op">=</span> <span class="st">"counties"</span></span></span>
<span class="r-in"><span>       , label <span class="op">=</span> <span class="st">"NAME"</span></span></span>
<span class="r-in"><span>       , popup <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>       , fill <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>       , fillColor <span class="op">=</span> <span class="st">"blue"</span></span></span>
<span class="r-in"><span>       , fillOpacity <span class="op">=</span> <span class="fl">0.6</span></span></span>
<span class="r-in"><span>       , color <span class="op">=</span> <span class="st">"black"</span></span></span>
<span class="r-in"><span>       , weight <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>     <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>       <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/addLayersControl.html" class="external-link">addLayersControl</a></span><span class="op">(</span>overlayGroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"counties"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>       <span class="fu"><a href="addMouseCoordinates.html">addMouseCoordinates</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>       <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-methods.html" class="external-link">setView</a></span><span class="op">(</span>lng <span class="op">=</span> <span class="op">-</span><span class="fl">105.644</span>, lat <span class="op">=</span> <span class="fl">51.618</span>, zoom <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tim Appelhans.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

